<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-haproxy docs-version-current docs-doc-page docs-doc-id-haproxy-1" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">HAProxy-安装及基础配置 | Ryan&#x27;s Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ryanxin7.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ryanxin7.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ryanxin7.github.io/haproxy/haproxy-1"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-haproxy-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-haproxy-current"><meta data-rh="true" property="og:title" content="HAProxy-安装及基础配置 | Ryan&#x27;s Wiki"><meta data-rh="true" name="description" content="三、HAProxy安装及基础配置"><meta data-rh="true" property="og:description" content="三、HAProxy安装及基础配置"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ryanxin7.github.io/haproxy/haproxy-1"><link data-rh="true" rel="alternate" href="https://ryanxin7.github.io/haproxy/haproxy-1" hreflang="en"><link data-rh="true" rel="alternate" href="https://ryanxin7.github.io/haproxy/haproxy-1" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UTHK6Z5YDW-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Ryan&#39;s Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Ryan&#39;s Wiki Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Ryan&#39;s Wiki" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.d3c714a5.css">
<script src="/assets/js/runtime~main.f6f6a36d.js" defer="defer"></script>
<script src="/assets/js/main.bc8ddf24.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Ryan&#x27;s wiki</b></a><a class="navbar__item navbar__link" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/k8s/intro">Kubernetes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/haproxy/haproxy-1">haproxy</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/haproxy/haproxy-1">HAProxy-安装及基础配置</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">HAProxy-安装及基础配置</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>HAProxy-安装及基础配置</h1></header><a name="45409794"></a>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="三haproxy安装及基础配置">三、HAProxy安装及基础配置<a class="hash-link" aria-label="Direct link to 三、HAProxy安装及基础配置" title="Direct link to 三、HAProxy安装及基础配置" href="/haproxy/haproxy-1#三haproxy安装及基础配置">​</a></h2>
<p>介绍HAProxy的基础安装及基础配置</p>
<a name="b62d7d45"></a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-源码包安装">3.1 源码包安装<a class="hash-link" aria-label="Direct link to 3.1 源码包安装" title="Direct link to 3.1 源码包安装" href="/haproxy/haproxy-1#31-源码包安装">​</a></h3>
<p>官方提供了Ubuntu和Debian的包，没有Centos的包<br><img decoding="async" loading="lazy" src="https://cdn1.ryanxin.live/1675997727329-efbe55ed-cb1e-4446-b7d2-40fd13d1031b.png#alt=" alt="" class="img_ev3q"></p>
<hr>
<p><img decoding="async" loading="lazy" src="https://cdn1.ryanxin.live/xxlog/1675997822880-a7a98a7a-9d66-4040-902e-4575f17bcaf5.png#alt=image.png" alt="" class="img_ev3q"></p>
<a name="0aa51ed0"></a>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ubuntu-安装">ubuntu 安装<a class="hash-link" aria-label="Direct link to ubuntu 安装" title="Direct link to ubuntu 安装" href="/haproxy/haproxy-1#ubuntu-安装">​</a></h4>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">get install </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">no</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">install</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">recommends software</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">properties</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">common </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#--no-install-recommends 参数来避免安装非必须的文件，从而减小镜像的体积</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">apt</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">repository ppa</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">vbernat/haproxy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">2.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">get install haproxy=2.6.\*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#安装常用软件包</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> --no-install-recommends software-properties-common </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#--no-install-recommends 参数来避免安装非必须的文件，从而减小镜像的体积</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#安装源</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@etcd01</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">11</span><span class="token plain">:10:22</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">~ </span><span class="token comment" style="color:#999988;font-style:italic">#:add-apt-repository ppa:vbernat/haproxy-2.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> HAProxy is a free, very fast and reliable solution offering high availability, load balancing, and proxying </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> TCP and HTTP-based applications. It is particularly suited </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> web sites crawling under very high loads </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> needing persistence or Layer7 processing. Supporting tens of thousands of connections is clearly realistic with todays hardware. Its mode of operation makes its integration into existing architectures very easy and riskless, </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> still offering the possibility not to expose fragile web servers to the Net.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This PPA contains packages </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> HAProxy </span><span class="token number" style="color:#36acaa">2.6</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> More info: https://launchpad.net/~vbernat/+archive/ubuntu/haproxy-2.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Press </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ENTER</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> to </span><span class="token builtin class-name">continue</span><span class="token plain"> or Ctrl-c to cancel adding it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get:1 http://ppa.launchpad.net/vbernat/haproxy-2.6/ubuntu focal InRelease </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">23.8</span><span class="token plain"> kB</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hit:2 http://cn.archive.ubuntu.com/ubuntu focal InRelease </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hit:3 http://cn.archive.ubuntu.com/ubuntu focal-updates InRelease</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hit:4 http://cn.archive.ubuntu.com/ubuntu focal-backports InRelease</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hit:5 http://cn.archive.ubuntu.com/ubuntu focal-security InRelease         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get:6 http://ppa.launchpad.net/vbernat/haproxy-2.6/ubuntu focal/main amd64 Packages </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1,000</span><span class="token plain"> B</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get:7 http://ppa.launchpad.net/vbernat/haproxy-2.6/ubuntu focal/main Translation-en </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">704</span><span class="token plain"> B</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fetched </span><span class="token number" style="color:#36acaa">25.5</span><span class="token plain"> kB </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> 2s </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">14.0</span><span class="token plain"> kB/s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reading package lists</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. Done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#查看可用版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@etcd01</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">11</span><span class="token plain">:11:01</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">~ </span><span class="token comment" style="color:#999988;font-style:italic">#:apt-cache madison haproxy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   haproxy </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.6</span><span class="token plain">.8-1ppa1~focal </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://ppa.launchpad.net/vbernat/haproxy-2.6/ubuntu focal/main amd64 Packages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   haproxy </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain">.29-0ubuntu1.1 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://cn.archive.ubuntu.com/ubuntu focal-updates/main amd64 Packages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   haproxy </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain">.29-0ubuntu1.1 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://cn.archive.ubuntu.com/ubuntu focal-security/main amd64 Packages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   haproxy </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain">.13-2 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://cn.archive.ubuntu.com/ubuntu focal/main amd64 Packages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#安装2.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">haproxy</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2.6</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">* </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#验证haproxy版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@etcd01</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:50:48</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">~ </span><span class="token comment" style="color:#999988;font-style:italic">#:haproxy -v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HAProxy version </span><span class="token number" style="color:#36acaa">2.6</span><span class="token plain">.8-1ppa1~focal </span><span class="token number" style="color:#36acaa">2023</span><span class="token plain">/01/24 - https://haproxy.org/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status: long-term supported branch - will stop receiving fixes around Q2 </span><span class="token number" style="color:#36acaa">2027</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Known bugs: http://www.haproxy.org/bugs/bugs-2.6.8.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running on: Linux </span><span class="token number" style="color:#36acaa">5.4</span><span class="token plain">.0-135-generic </span><span class="token comment" style="color:#999988;font-style:italic">#152-Ubuntu SMP Wed Nov 23 20:19:22 UTC 2022 x86_64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<a name="f1c7cd61"></a>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="centos安装">Centos安装<a class="hash-link" aria-label="Direct link to Centos安装" title="Direct link to Centos安装" href="/haproxy/haproxy-1#centos安装">​</a></h4>
<p>在centos系统上通过yum、编译等多种安装方式。<br><strong>默认yum源</strong><br>默认的base仓库中包含haproxy的安装包文件，但是版本比较旧，是1.5.18的版本，距离当前版本已经有较长时间没有更新，由于版本比较旧所以有很多功能不支持，如果对功能和性能没有要求可以使用此版本，否则推荐使用新版本。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># yum install haproxy -y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#验证haproxy版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># haproxy -v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HA-Proxy version </span><span class="token number" style="color:#36acaa">1.5</span><span class="token plain">.18 </span><span class="token number" style="color:#36acaa">2016</span><span class="token plain">/05/10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain">-2016 Willy Tarreau </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">willy@haproxy.org</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<a name="ce56c46c"></a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-编译安装haproxy">3.2 编译安装HAProxy<a class="hash-link" aria-label="Direct link to 3.2 编译安装HAProxy" title="Direct link to 3.2 编译安装HAProxy" href="/haproxy/haproxy-1#32-编译安装haproxy">​</a></h3>
<p>编译安装HAProxy 2.0 LTS版本，源码包下载地址：<a href="http://www.haproxy.org/download/" target="_blank" rel="noopener noreferrer">http://www.haproxy.org/download/</a></p>
<a name="5ffc492b"></a>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="321-解决lua环境">3.2.1 解决lua环境<a class="hash-link" aria-label="Direct link to 3.2.1 解决lua环境" title="Direct link to 3.2.1 解决lua环境" href="/haproxy/haproxy-1#321-解决lua环境">​</a></h4>
<p>HAProxy支持基于lua实现功能扩展，lua是一种小巧的脚本语言，于1993年由巴西里约热内卢天主教大学（Pontiﬁcal Catholic University of Rio de Janeiro）里的一个研究小组开发，其设计目的是为了嵌入应用程序中，从而为应用程序提供灵活的扩展和定制功能。</p>
<p>Lua 官网：<a href="http://www.lua.org" target="_blank" rel="noopener noreferrer">www.lua.org</a></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Lua应用场景</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">游戏开发</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">独立应用脚本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Web应用脚本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">扩展和数据库插件，如MySQL Proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">安全系统，如入侵检测系统</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<p><strong>Centos 环境</strong>：<br>由于centos自带的lua版本比较低并不符合HAProxy要求的lua最低版本(5.3)的要求，因此需要编译安装较新版本的lua环境，然后才能编译安装HAProxy，过程如下：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#当前系统版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 ~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic">#lua -v </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Lua </span><span class="token number" style="color:#36acaa">5.1</span><span class="token plain">.4  Copyright </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1994</span><span class="token plain">-2008 Lua.org, PUC-Rio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#安装基础命令及编译依赖环境</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 ~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># yum install gcc readline-devel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 ~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># wget http://www.lua.org/ftp/lua-5.3.5.tar.gz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 ~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># tar xvf  lua-5.3.5.tar.gz -C /usr/local/src</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 ~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># cd /usr/local/src/lua-5.3.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 lua-5.3.5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># make linux test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@localhost lua-5.3.5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># make linux test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> src </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: 进入目录“/usr/local/src/lua-5.3.5/src”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> all </span><span class="token assign-left variable" style="color:#36acaa">SYSCFLAGS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-DLUA_USE_LINUX&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">SYSLIBS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-Wl,-E -ldl -lreadline&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: 进入目录“/usr/local/src/lua-5.3.5/src”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lapi.o lapi.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lcode.o lcode.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lctype.o lctype.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> ldebug.o ldebug.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> ldo.o ldo.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> ldump.o ldump.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lfunc.o lfunc.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lgc.o lgc.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> llex.o llex.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lmem.o lmem.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lobject.o lobject.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lopcodes.o lopcodes.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lparser.o lparser.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lstate.o lstate.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lstring.o lstring.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> ltable.o ltable.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> ltm.o ltm.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lundump.o lundump.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lvm.o lvm.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lzio.o lzio.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lauxlib.o lauxlib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lbaselib.o lbaselib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lbitlib.o lbitlib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lcorolib.o lcorolib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> ldblib.o ldblib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> liolib.o liolib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lmathlib.o lmathlib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> loslib.o loslib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lstrlib.o lstrlib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> ltablib.o ltablib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lutf8lib.o lutf8lib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> loadlib.o loadlib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> linit.o linit.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ar rcu liblua.a lapi.o lcode.o lctype.o ldebug.o ldo.o ldump.o lfunc.o lgc.o llex.o lmem.o lobject.o lopcodes.o lparser.o lstate.o lstring.o ltable.o ltm.o lundump.o lvm.o lzio.o lauxlib.o lbaselib.o lbitlib.o lcorolib.o ldblib.o liolib.o lmathlib.o loslib.o lstrlib.o ltablib.o lutf8lib.o loadlib.o linit.o </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ranlib liblua.a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lua.o lua.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> lua   lua.o liblua.a </span><span class="token parameter variable" style="color:#36acaa">-lm</span><span class="token plain"> -Wl,-E </span><span class="token parameter variable" style="color:#36acaa">-ldl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-lreadline</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-O2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wall</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_COMPAT_5_2</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-DLUA_USE_LINUX</span><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> luac.o luac.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc </span><span class="token parameter variable" style="color:#36acaa">-std</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gnu99 </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> luac   luac.o liblua.a </span><span class="token parameter variable" style="color:#36acaa">-lm</span><span class="token plain"> -Wl,-E </span><span class="token parameter variable" style="color:#36acaa">-ldl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-lreadline</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: 离开目录“/usr/local/src/lua-5.3.5/src”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: 离开目录“/usr/local/src/lua-5.3.5/src”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">src/lua </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Lua </span><span class="token number" style="color:#36acaa">5.3</span><span class="token plain">.5  Copyright </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1994</span><span class="token plain">-2018 Lua.org, PUC-Rio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#查看编译安装的版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@localhost lua-5.3.5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># ./src/lua -v </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Lua </span><span class="token number" style="color:#36acaa">5.3</span><span class="token plain">.5  Copyright </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1994</span><span class="token plain">-2018 Lua.org, PUC-Rio</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<p><strong>Ubuntu 基础环境</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#安装基础命令 及编译依赖环境</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain">  </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> gcc iproute2  ntpdate  tcpdump telnet </span><span class="token function" style="color:#d73a49">traceroute</span><span class="token plain"> nfs-kernel-server nfs-common  lrzsz tree  openssl libssl-dev libpcre3 libpcre3-dev zlib1g-dev  openssh-server  libreadline-dev libsystemd-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> /usr/local/src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> http://www.lua.org/ftp/lua-5.3.5.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> xvf  lua-5.3.5.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> lua-5.3.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> linux </span><span class="token builtin class-name">test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">pwd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/local/src/lua-5.3.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./src/lua </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Lua </span><span class="token number" style="color:#36acaa">5.3</span><span class="token plain">.5  Copyright </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1994</span><span class="token plain">-2018 Lua.org, PUC-Rio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#或安装系统自带的lua</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain">  </span><span class="token assign-left variable" style="color:#36acaa">lua5.3</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5.3</span><span class="token plain">.3-1ubuntu0.18.04.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ lua5.3  </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Lua </span><span class="token number" style="color:#36acaa">5.3</span><span class="token plain">.3  Copyright </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1994</span><span class="token plain">-2016 Lua.org, PUC-Rio</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<a name="2ebe16a6"></a>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="322-开始编译安装">3.2.2 开始编译安装<a class="hash-link" aria-label="Direct link to 3.2.2 开始编译安装" title="Direct link to 3.2.2 开始编译安装" href="/haproxy/haproxy-1#322-开始编译安装">​</a></h4>
<p><strong>Centos 环境</strong><br><strong>ubuntu 系统推荐使用包管理器安装</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#HAProxy  1.8及1.9版本编译参数：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain">  </span><span class="token assign-left variable" style="color:#36acaa">ARCH</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">x86_64 </span><span class="token assign-left variable" style="color:#36acaa">TARGET</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">linux2628 </span><span class="token assign-left variable" style="color:#36acaa">USE_PCRE</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">USE_OPENSSL</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">USE_ZLIB</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">USE_SYSTEMD</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">  </span><span class="token assign-left variable" style="color:#36acaa">USE_CPU_AFFINITY</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">  </span><span class="token assign-left variable" style="color:#36acaa">PREFIX</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/local/haproxy </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#HAProxy 2.0以上版本编译参数：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 ~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">$ yum </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> gcc openssl-devel pcre-devel systemd-devel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">已安装:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  openssl-devel.x86_64 </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">:1.0.2k-25.el7_9                              systemd-devel.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:219-78.el7_9.7                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">作为依赖被安装:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  keyutils-libs-devel.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:1.5.8-3.el7       krb5-devel.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:1.15.1-55.el7_9        libcom_err-devel.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:1.42.9-19.el7      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  libkadm5.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:1.15.1-55.el7_9              libselinux-devel.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:2.5-15.el7       libsepol-devel.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:2.5-10.el7           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  libverto-devel.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0.2.5-4.el7           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">作为依赖被升级:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  e2fsprogs.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:1.42.9-19.el7            e2fsprogs-libs.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:1.42.9-19.el7         krb5-libs.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:1.15.1-55.el7_9         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  libcom_err.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:1.42.9-19.el7           libgudev1.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:219-78.el7_9.7             libss.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:1.42.9-19.el7               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  openssl.x86_64 </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">:1.0.2k-25.el7_9            openssl-libs.x86_64 </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">:1.0.2k-25.el7_9         systemd.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:219-78.el7_9.7            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  systemd-libs.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:219-78.el7_9.7        systemd-python.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:219-78.el7_9.7        systemd-sysv.x86_64 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:219-78.el7_9.7 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 ~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">$ </span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> xvf haproxy-2.6.8.tar.gz </span><span class="token parameter variable" style="color:#36acaa">-C</span><span class="token plain"> /usr/local/src/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 ~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> /usr/local/src/haproxy-2.6.8/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 haproxy-2.6.8</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> README </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The HAProxy documentation has been </span><span class="token function" style="color:#d73a49">split</span><span class="token plain"> into a number of different files </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ease of use.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Please refer to the following files depending on what you</span><span class="token string" style="color:#e3116c">&#x27;re looking for :</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - INSTALL for instructions on how to build and install HAProxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - BRANCHES to understand the project&#x27;</span><span class="token plain">s life cycle and what version to use</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - LICENSE </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> the project</span><span class="token string" style="color:#e3116c">&#x27;s license</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - CONTRIBUTING for the process to follow to submit contributions</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">The more detailed documentation is located into the doc/ directory :</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - doc/intro.txt for a quick introduction on HAProxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - doc/configuration.txt for the configuration&#x27;</span><span class="token plain">s reference manual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - doc/lua.txt </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> the Lua</span><span class="token string" style="color:#e3116c">&#x27;s reference manual</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - doc/SPOE.txt for how to use the SPOE engine</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - doc/network-namespaces.txt for how to use network namespaces under Linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - doc/management.txt for the management guide</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - doc/regression-testing.txt for how to use the regression testing suite</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - doc/peers.txt for the peers protocol reference</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  - doc/coding-style.txt for how to adopt HAProxy&#x27;</span><span class="token plain">s coding style</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - doc/internals </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> developer-specific documentation </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">not all up to </span><span class="token function" style="color:#d73a49">date</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@centos7 haproxy-2.6.8</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> INSTALL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#参考INSTALL文件进行编译安装</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">make</span><span class="token plain">  </span><span class="token assign-left variable" style="color:#36acaa">ARCH</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">x86_64 </span><span class="token assign-left variable" style="color:#36acaa">TARGET</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">linux-glibc  </span><span class="token assign-left variable" style="color:#36acaa">USE_PCRE</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">USE_OPENSSL</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">USE_ZLIB</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">  </span><span class="token assign-left variable" style="color:#36acaa">USE_SYSTEMD</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">USE_CPU_AFFINITY</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">USE_LUA</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">LUA_INC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/local/src/lua-5.3.5/src/  </span><span class="token assign-left variable" style="color:#36acaa">LUA_LIB</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/local/src/lua-5.3.5/src/ </span><span class="token assign-left variable" style="color:#36acaa">PREFIX</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/local/haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ev_poll.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ev_epoll.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cpuset.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ssl_sample.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ssl_sock.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ssl_crtlist.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ssl_ckch.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ssl_utils.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cfgparse-ssl.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/jwt.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/hlua.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/hlua_fcn.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/namespace.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/mux_h2.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/mux_fcgi.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/mux_h1.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/tcpcheck.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/stream.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/stats.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/http_ana.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/server.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/stick_table.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/sample.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/flt_spoe.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/tools.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/log.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cfgparse.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/peers.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/backend.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/resolvers.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cli.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/connection.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/proxy.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/http_htx.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cfgparse-listen.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/pattern.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/check.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/haproxy.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cache.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/stconn.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/http_act.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/http_fetch.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/http_client.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/listener.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/dns.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/vars.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/debug.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/tcp_rules.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/sink.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/h1_htx.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/task.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/mjson.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/h2.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/filters.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/server_state.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/payload.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/fcgi-app.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/map.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/htx.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/h1.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/pool.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cfgparse-global.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/trace.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/tcp_sample.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/flt_http_comp.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/mux_pt.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/flt_trace.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/mqtt.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/acl.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/sock.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/mworker.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/tcp_act.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ring.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/session.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/proto_tcp.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/fd.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/channel.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/activity.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/queue.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/lb_fas.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/http_rules.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/extcheck.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/thread.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/http.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/lb_chash.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/applet.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/compression.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/raw_sock.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ncbuf.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/frontend.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/errors.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/uri_normalizer.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/http_conv.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/lb_fwrr.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/sha1.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/proto_sockpair.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/mailers.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/lb_fwlc.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ebmbtree.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cfgcond.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/action.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/xprt_handshake.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/protocol.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/proto_uxst.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/proto_udp.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/lb_map.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/fix.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ev_select.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/arg.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/sock_inet.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/mworker-prog.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/hpack-dec.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cfgparse-tcp.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/sock_unix.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/shctx.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/proto_uxdg.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/fcgi.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/eb64tree.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/clock.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/chunk.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cfgdiag.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/signal.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/regex.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/lru.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/eb32tree.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/eb32sctree.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/cfgparse-unix.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/hpack-tbl.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ebsttree.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ebimtree.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/base64.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/auth.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/uri_auth.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/time.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ebistree.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/dynbuf.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/wdt.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/pipe.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/init.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/http_acl.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/hpack-huff.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/hpack-enc.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/dict.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/freq_ctr.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/ebtree.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/hash.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/dgram.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      src/version.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LD      haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC      dev/flags/flags.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LD      dev/flags/flags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">PREFIX</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/local/haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ln</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> /usr/local/haproxy/sbin/haproxy /usr/sbin/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#验证版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@localhost haproxy</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># haproxy -v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HAProxy version </span><span class="token number" style="color:#36acaa">2.6</span><span class="token plain">.8-ab6ee7f </span><span class="token number" style="color:#36acaa">2023</span><span class="token plain">/01/24 - https://haproxy.org/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status: long-term supported branch - will stop receiving fixes around Q2 </span><span class="token number" style="color:#36acaa">2027</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Known bugs: http://www.haproxy.org/bugs/bugs-2.6.8.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running on: Linux </span><span class="token number" style="color:#36acaa">3.10</span><span class="token plain">.0-1127.8.2.el7.x86_64 </span><span class="token comment" style="color:#999988;font-style:italic">#1 SMP Tue May 12 16:57:42 UTC 2020 x86_64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<a name="3d87368c"></a>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="323-haproxy启动脚本">3.2.3 HAProxy启动脚本<a class="hash-link" aria-label="Direct link to 3.2.3 HAProxy启动脚本" title="Direct link to 3.2.3 HAProxy启动脚本" href="/haproxy/haproxy-1#323-haproxy启动脚本">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">vim</span><span class="token plain">   /usr/lib/systemd/system/haproxy.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Unit</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">Description</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">HAProxy Load Balancer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">After</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">syslog.target network.target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Service</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ExecStartPre</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/sbin/haproxy </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> /etc/haproxy/haproxy.cfg  </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ExecStart</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/sbin/haproxy </span><span class="token parameter variable" style="color:#36acaa">-Ws</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> /etc/haproxy/haproxy.cfg </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> /var/lib/haproxy/haproxy.pid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ExecReload</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/bin/kill </span><span class="token parameter variable" style="color:#36acaa">-USR2</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$MAINPID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Install</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">WantedBy</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">multi-user.target</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<a name="ca1a39af"></a>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="324-创建配置文件">3.2.4 创建配置文件<a class="hash-link" aria-label="Direct link to 3.2.4 创建配置文件" title="Direct link to 3.2.4 创建配置文件" href="/haproxy/haproxy-1#324-创建配置文件">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain">  /etc/haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">vim</span><span class="token plain"> /etc/haproxy/haproxy.cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    maxconn </span><span class="token number" style="color:#36acaa">100000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">chroot</span><span class="token plain"> /apps/haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stats socket /var/lib/haproxy/haproxy.sock mode </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> level admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#uid 99</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#gid 99</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user  haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    group haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    daemon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#nbproc 4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#cpu-map 1 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#cpu-map 2 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#cpu-map 3 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#cpu-map 4 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pidfile /var/lib/haproxy/haproxy.pid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1 local2 info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">defaults</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    option http-keep-alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    option  forwardfor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    maxconn </span><span class="token number" style="color:#36acaa">100000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mode http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">timeout</span><span class="token plain"> connect 300000ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">timeout</span><span class="token plain"> client  300000ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">timeout</span><span class="token plain"> server  300000ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listen stats</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mode http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">bind</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:9999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stats </span><span class="token builtin class-name">enable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stats uri     /haproxy-status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stats auth    haadmin:123456</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listen  web_port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">bind</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.0.6:30013</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mode http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    option forwardfor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server web1  </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.0.31:30013  check inter </span><span class="token number" style="color:#36acaa">3000</span><span class="token plain"> fall </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> rise </span><span class="token number" style="color:#36acaa">5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<a name="8da5a3ae"></a>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="325-启动haproxy">3.2.5  启动haproxy<a class="hash-link" aria-label="Direct link to 3.2.5  启动haproxy" title="Direct link to 3.2.5  启动haproxy" href="/haproxy/haproxy-1#325-启动haproxy">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain">  /var/lib/haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chown</span><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-R</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99.99</span><span class="token plain"> /var/lib/haproxy/ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">useradd</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> /sbin/nologin </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> /var/lib/haproxy haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status haproxy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<a name="b02a49a0"></a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-验证haproxy状态">3.3 验证haproxy状态<a class="hash-link" aria-label="Direct link to 3.3 验证haproxy状态" title="Direct link to 3.3 验证haproxy状态" href="/haproxy/haproxy-1#33-验证haproxy状态">​</a></h3>
<a name="309825cc"></a>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="331-验证监听端口">3.3.1 验证监听端口<a class="hash-link" aria-label="Direct link to 3.3.1 验证监听端口" title="Direct link to 3.3.1 验证监听端口" href="/haproxy/haproxy-1#331-验证监听端口">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@localhost haproxy</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># ss -tnl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">State       Recv-Q Send-Q          Local Address:Port      Peer Address:Port              </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">128</span><span class="token plain">                 </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:631                  *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">100</span><span class="token plain">                         *:8088                 *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">                   </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:31769                *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">100</span><span class="token plain">                 </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:25                   *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">128</span><span class="token plain">                         *:1883                 *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">128</span><span class="token plain">                         *:30013                *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">50</span><span class="token plain">                          *:8161                 *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">                   </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:8005                 *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">128</span><span class="token plain">                         *:5672                 *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">50</span><span class="token plain">                          *:43178                *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">128</span><span class="token plain">                         *:6379                 *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">128</span><span class="token plain">                         *:61613                *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">50</span><span class="token plain">                          *:61614                *:*                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LISTEN      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">128</span><span class="token plain">                         *:9999                 *:*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<a name="af73fc56"></a>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="332-查看haproxy的状态页面">3.3.2 查看haproxy的状态页面<a class="hash-link" aria-label="Direct link to 3.3.2 查看haproxy的状态页面" title="Direct link to 3.3.2 查看haproxy的状态页面" href="/haproxy/haproxy-1#332-查看haproxy的状态页面">​</a></h4>
<p>浏览器访问：<a href="http://www.yunweipai.com/go?_=84a56fb1feaHR0cDovL2hhcHJveHktc2VydmVyOjk5OTkvaGFwcm94eS1zdGF0dXM%3D" target="_blank" rel="noopener noreferrer">http://haproxy-server:9999/haproxy-status</a><br><img decoding="async" loading="lazy" src="https://cdn1.ryanxin.live/1676021477593-8a91dd15-dde3-4cc1-a009-f117f39f08f9.png#alt=" alt="" class="img_ev3q"></p>
<a name="fa61ee46"></a>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="333-测试转发">3.3.3 测试 转发<a class="hash-link" aria-label="Direct link to 3.3.3 测试转发" title="Direct link to 3.3.3 测试转发" href="/haproxy/haproxy-1#333-测试转发">​</a></h4>
<p>10.1.0.6:30013 转发到 10.1.0.31:30013 ✅</p>
<p><img decoding="async" loading="lazy" src="https://cdn1.ryanxin.live/1676254179452-d15ddfd6-e6e2-4d2c-8d3a-691d48309fcf.png#alt=" alt="" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/src/haproxy/Haproxy-1.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/haproxy/haproxy-1#三haproxy安装及基础配置">三、HAProxy安装及基础配置</a><ul><li><a class="table-of-contents__link toc-highlight" href="/haproxy/haproxy-1#31-源码包安装">3.1 源码包安装</a></li><li><a class="table-of-contents__link toc-highlight" href="/haproxy/haproxy-1#32-编译安装haproxy">3.2 编译安装HAProxy</a></li><li><a class="table-of-contents__link toc-highlight" href="/haproxy/haproxy-1#33-验证haproxy状态">3.3 验证haproxy状态</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>